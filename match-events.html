<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>События матча - EVILBET</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preload" href="https://fonts.gstatic.com/s/bebasneue/v9/JTUSjIg69CK48gW7PXoo9Wlhyw.woff2" as="font" type="font/woff2" crossorigin>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @font-face {
            font-family: 'Bebas Neue Cyrillic';
            src: local('Bebas Neue Cyrillic'), local('BebasNeueCyrillic'),
                 url('https://fonts.gstatic.com/s/bebasneue/v9/JTUSjIg69CK48gW7PXoo9Wlhyw.woff2') format('woff2');
            unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
            font-weight: 400;
            font-style: normal;
        }

        @font-face {
            font-family: 'Bebas Neue';
            src: local('Bebas Neue'), local('BebasNeue'),
                 url('https://fonts.gstatic.com/s/bebasneue/v9/JTUSjIg69CK48gW7PXoo9Wlhyw.woff2') format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
            font-weight: 400;
            font-style: normal;
        }

        :root {
            --primary-color: #ff3333;
            --primary-hover: #cc0000;
            --secondary-color: #ff6666;
            --bg-primary: #121212;
            --bg-secondary: #1a1a1a;
            --text-primary: #fff;
            --text-secondary: #aaa;
            --success-color: #4caf50;
            --neon-glow: 0 0 20px rgba(255, 51, 51, 0.5);
            --gradient-primary: linear-gradient(45deg, var(--primary-color), #ff0066);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, var(--bg-primary), var(--bg-secondary));
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .tg-ready {
            padding-top: 60px;
        }

        /* **HEADER - В СТИЛЕ CS POSITIVE** */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 16px;
            background: rgba(18, 18, 18, 0.98);
            position: fixed;
            width: 100vw;
            left: 0;
            top: 0;
            z-index: 100;
            height: 60px;
            border-bottom: 2px solid transparent;
            background-image: linear-gradient(rgba(18,18,18,0.98), rgba(18,18,18,0.98)),
                              linear-gradient(90deg, var(--primary-color), transparent);
            background-size: 100% 100%, 100% 2px;
            background-position: 0 0, 0 100%;
            background-repeat: no-repeat;
            backdrop-filter: blur(10px);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
            flex: 1;
        }

        #logo.header-logo {
            width: 70px;
            height: auto;
            filter: drop-shadow(0 0 10px rgba(255, 51, 51, 0.3));
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 12px;
        }

        nav ul li a {
            color: var(--text-primary);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 400;
            transition: all 0.3s ease;
            text-transform: uppercase;
            position: relative;
        }

        nav ul li a:hover {
            color: var(--primary-color);
            text-shadow: var(--neon-glow);
        }

        nav ul li a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -4px;
            left: 0;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        nav ul li a:hover::after {
            width: 100%;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(30, 30, 30, 0.8);
            border-radius: 6px;
            padding: 6px 12px;
            border: 1px solid rgba(255, 51, 51, 0.2);
        }

        .balance-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }

        .balance-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 2px;
        }

        .balance-value {
            font-size: 1rem;
            color: var(--primary-color);
            font-weight: 400;
            text-shadow: 0 0 5px rgba(255, 51, 51, 0.3);
        }

        .user-name {
            font-size: 0.95rem;
            color: var(--text-primary);
            padding: 4px 8px;
            background: rgba(0, 255, 136, 0.2);
            border-radius: 4px;
            cursor: pointer;
            font-weight: 400;
            text-transform: uppercase;
            border: 1px solid rgba(0, 255, 136, 0.3);
            transition: all 0.3s ease;
        }

        .user-name:hover {
            background: rgba(0, 255, 136, 0.3);
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.4);
        }

        .auth-buttons {
            display: flex;
            gap: 8px;
        }

        .auth-btn {
            padding: 6px 12px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }

        .auth-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .auth-btn:hover::before {
            left: 100%;
        }

        .login-btn {
            background: #333;
            color: var(--text-primary);
        }

        .login-btn:hover {
            background: #444;
            box-shadow: var(--neon-glow);
        }

        .register-btn {
            background: var(--gradient-primary);
            color: #000;
        }

        .register-btn:hover {
            box-shadow: var(--neon-glow);
        }

        .telegram-auth-btn {
            background: var(--gradient-primary);
            color: #000;
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            transition: all 0.3s;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }

        .telegram-auth-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .telegram-auth-btn:hover::before {
            left: 100%;
        }

        .telegram-auth-btn:hover {
            transform: scale(1.02);
            box-shadow: var(--neon-glow);
        }

        .notifications {
            position: relative;
        }

        .notifications-btn {
            background: var(--gradient-primary);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            box-shadow: var(--neon-glow);
        }

        .notifications-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(255, 51, 51, 0.7);
        }

        .notification-count {
            position: absolute;
            top: -4px;
            right: -4px;
            background: #4caf50;
            color: #fff;
            font-size: 0.6rem;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 400;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-5px); }
            60% { transform: translateY(-3px); }
        }

        .contact-btn {
            background: var(--gradient-primary);
            padding: 6px 12px;
            border-radius: 4px;
            text-decoration: none;
            color: #000;
            font-size: 0.8rem;
            white-space: nowrap;
            font-weight: 400;
            transition: all 0.3s;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }

        .contact-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .contact-btn:hover::before {
            left: 100%;
        }

        .contact-btn:hover {
            box-shadow: var(--neon-glow);
        }

        .deposit-btn {
            background: var(--gradient-primary);
            padding: 6px 12px;
            border-radius: 4px;
            color: #000;
            font-size: 0.8rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            font-weight: 400;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }

        .deposit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .deposit-btn:hover::before {
            left: 100%;
        }

        .deposit-btn:hover {
            transform: scale(1.05);
            box-shadow: var(--neon-glow);
        }

        /* **MAIN CONTAINER** */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            position: relative;
        }

        .events-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* **BACK BUTTON** */
        .back-button {
            background: var(--gradient-primary);
            color: #000;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-size: 1.1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            text-transform: uppercase;
            align-self: flex-start;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(255, 51, 51, 0.3);
        }

        .back-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s;
        }

        .back-button:hover::before {
            width: 300px;
            height: 300px;
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 51, 51, 0.4);
        }

        /* **MATCH HEADER - УЛУЧШЕННЫЙ** */
        .match-header {
            background: linear-gradient(145deg, rgba(18,18,18,0.95), rgba(40,40,40,0.9));
            border-radius: 16px;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            border: 1px solid rgba(255, 51, 51, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
            animation: slideInUp 0.6s ease;
        }

        .match-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            box-shadow: 0 0 15px rgba(255, 51, 51, 0.5);
        }

        @keyframes slideInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .match-header::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 51, 51, 0.3), transparent);
        }

        .match-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            position: relative;
            z-index: 2;
        }

        .match-time {
            font-size: 1.3rem;
            color: #fff;
            background: var(--gradient-primary);
            padding: 8px 16px;
            border-radius: 25px;
            font-weight: 400;
            text-transform: uppercase;
            box-shadow: var(--neon-glow);
            position: relative;
            overflow: hidden;
            animation: pulseTime 2s infinite;
        }

        @keyframes pulseTime {
            0%, 100% { box-shadow: var(--neon-glow); }
            50% { box-shadow: 0 0 30px rgba(255, 51, 51, 0.8); }
        }

        .match-league {
            font-size: 1.8rem;
            color: var(--text-primary);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            z-index: 2;
        }

        /* **LIVE ИНДИКАТОР** */
        #liveIndicator {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(45deg, #ff4444, #ff0066);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            z-index: 10;
            box-shadow: 0 0 20px rgba(255, 68, 68, 0.6);
            animation: livePulse 1.5s infinite;
        }

        @keyframes livePulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 0 20px rgba(255, 68, 68, 0.6);
            }
            50% { 
                transform: scale(1.05); 
                box-shadow: 0 0 30px rgba(255, 68, 68, 0.9);
            }
        }

        /* **SCORE DISPLAY** */
        #liveScore, #finalScore {
            text-align: center;
            margin: 15px 0;
            font-size: 2.5rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            position: relative;
            z-index: 2;
        }

        #liveScore {
            color: #ff4444;
            animation: scoreBlink 1s infinite;
        }

        @keyframes scoreBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        #finalScore {
            color: var(--success-color);
        }

        .match-teams {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 40px;
            position: relative;
            z-index: 2;
        }

        .team {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            flex: 1;
            position: relative;
        }

        .team-logo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(145deg, #333, #444);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            border: 3px solid rgba(255, 51, 51, 0.3);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            text-transform: uppercase;
            color: var(--text-primary);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .team-logo::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .team-logo:hover::before {
            left: 100%;
        }

        .team-logo:hover {
            transform: scale(1.1);
            border-color: var(--primary-color);
            box-shadow: 0 0 30px rgba(255, 51, 51, 0.5);
        }

        .team-name {
            font-size: 1.6rem;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            text-transform: uppercase;
            letter-spacing: 1px;
            max-width: 150px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .match-vs {
            font-size: 2rem;
            color: var(--text-secondary);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            text-transform: uppercase;
            font-weight: bold;
            position: relative;
        }

        .match-vs::after {
            content: '⚔️';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.5rem;
            animation: swordShake 2s infinite;
        }

        @keyframes swordShake {
            0%, 100% { transform: translateX(-50%) rotate(0deg); }
            25% { transform: translateX(-50%) rotate(5deg); }
            75% { transform: translateX(-50%) rotate(-5deg); }
        }

        /* **MATCH INFO BAR** */
        #matchInfo {
            background: rgba(40,40,40,0.8);
            border-radius: 12px;
            padding: 12px;
            margin-top: 15px;
            font-size: 0.85rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            text-align: center;
            border: 1px solid rgba(255, 51, 51, 0.2);
            backdrop-filter: blur(10px);
        }

        #matchInfo span {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: var(--text-secondary);
        }

        #matchInfo i {
            color: var(--primary-color);
            font-size: 1rem;
        }

        /* **EVENTS SECTIONS** */
        .events-section {
            background: linear-gradient(145deg, rgba(18,18,18,0.95), rgba(40,40,40,0.9));
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 51, 51, 0.2);
            position: relative;
            overflow: hidden;
            animation: slideIn 0.5s ease;
            margin-bottom: 20px;
        }

        .events-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            box-shadow: 0 0 15px rgba(255, 51, 51, 0.4);
        }

        .events-section::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 51, 51, 0.2), transparent);
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 51, 51, 0.3);
            text-shadow: 0 0 20px rgba(255, 51, 51, 0.3);
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title i {
            font-size: 1.4rem;
            color: var(--primary-color);
            text-shadow: 0 0 10px rgba(255, 51, 51, 0.5);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background: var(--gradient-primary);
            box-shadow: 0 0 10px rgba(255, 51, 51, 0.4);
        }

        /* **EVENTS GRID** */
        .events-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }

        /* **EVENT ITEM - УЛУЧШЕННЫЙ** */
        .event-item {
            background: linear-gradient(145deg, rgba(26,26,26,0.9), rgba(40,40,40,0.8));
            border-radius: 12px;
            padding: 18px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 51, 51, 0.2);
            position: relative;
            overflow: hidden;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .event-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-primary);
            transform: scaleX(0);
            transition: transform 0.3s ease;
            z-index: 2;
        }

        .event-item::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.4s, height 0.4s;
            z-index: 1;
        }

        .event-item:hover::before {
            transform: scaleX(1);
        }

        .event-item:hover::after {
            width: 200px;
            height: 200px;
        }

        .event-item:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 40px rgba(255, 51, 51, 0.3);
            border-color: var(--primary-color);
        }

        .event-item.selected {
            background: linear-gradient(145deg, rgba(0,255,136,0.15), rgba(76,175,80,0.1)) !important;
            border-color: var(--success-color) !important;
            box-shadow: 0 0 25px rgba(76, 175, 80, 0.4) !important;
            transform: scale(1.03);
        }

        .event-item.selected::before {
            background: linear-gradient(45deg, var(--success-color), #66bb6a) !important;
        }

        /* **СТАТИСТИКА - ОСОБЫЙ СТИЛЬ** */
        .event-item.stat-item {
            background: linear-gradient(145deg, rgba(40,40,40,0.8), rgba(60,60,60,0.7)) !important;
            cursor: default !important;
            opacity: 0.85;
            border-style: dashed !important;
            border-color: rgba(255, 51, 51, 0.3) !important;
            min-height: 100px;
            position: relative;
        }

        .event-item.stat-item:hover {
            transform: none !important;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
            border-color: rgba(255, 51, 51, 0.3) !important;
        }

        .event-name {
            font-size: 1rem;
            margin-bottom: 8px;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            z-index: 3;
        }

        .event-odds {
            font-size: 1.5rem;
            font-weight: 400;
            color: var(--primary-color);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            position: relative;
            z-index: 3;
            transition: all 0.3s ease;
        }

        .event-item:hover .event-odds {
            text-shadow: 0 0 15px rgba(255, 51, 51, 0.6);
            transform: scale(1.1);
        }

        .event-item.selected .event-odds {
            color: var(--success-color) !important;
            text-shadow: 0 0 15px rgba(76, 175, 80, 0.6) !important;
        }

        /* **BETS COUPON - В СТИЛЕ SPORT** */
        .bet-coupon {
            background: rgba(20, 20, 20, 0.98);
            border-radius: 16px;
            padding: 20px;
            position: fixed;
            top: 70px;
            right: 20px;
            width: 340px;
            max-height: 75vh;
            overflow-y: auto;
            z-index: 90;
            display: block;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 12px 40px rgba(255, 51, 51, 0.3);
            border: 1px solid rgba(255, 51, 51, 0.3);
            backdrop-filter: blur(10px);
        }

        .bet-coupon.visible {
            opacity: 1;
            transform: translateX(0);
        }

        .bet-coupon:not(.visible) {
            transform: translateX(100%);
        }

        .coupon-close {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(51, 51, 51, 0.8);
            color: var(--text-primary);
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            z-index: 100;
        }

        .coupon-close:hover {
            background: var(--gradient-primary);
            color: #000;
            transform: rotate(90deg) scale(1.1);
            box-shadow: var(--neon-glow);
        }

        .coupon-tabs {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
            gap: 6px;
            position: relative;
        }

        .coupon-tab {
            flex: 1;
            background: rgba(51, 51, 51, 0.8);
            color: var(--text-primary);
            border: none;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-size: 0.95rem;
            text-align: center;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .coupon-tab::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        .coupon-tab:hover::before {
            width: 100%;
        }

        .coupon-tab.active {
            background: var(--gradient-primary);
            color: #000;
            box-shadow: var(--neon-glow);
        }

        .coupon-tab:hover:not(.active) {
            background: rgba(255, 51, 51, 0.1);
            border-color: var(--primary-color);
        }

        .coupon-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 51, 51, 0.3);
            position: relative;
        }

        .coupon-title {
            font-size: 1.6rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: bold;
        }

        .clear-coupon {
            background: rgba(51, 51, 51, 0.8);
            color: var(--text-primary);
            border: none;
            padding: 8px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }

        .clear-coupon::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .clear-coupon:hover::before {
            left: 100%;
        }

        .clear-coupon:hover {
            background: var(--gradient-primary);
            color: #000;
            box-shadow: var(--neon-glow);
            transform: translateX(5px);
        }

        .coupon-items, .coupon-history {
            margin-bottom: 16px;
            max-height: 280px;
            overflow-y: auto;
        }

        .coupon-items::-webkit-scrollbar,
        .coupon-history::-webkit-scrollbar {
            width: 6px;
        }

        .coupon-items::-webkit-scrollbar-track,
        .coupon-history::-webkit-scrollbar-track {
            background: rgba(34, 34, 34, 0.5);
            border-radius: 3px;
        }

        .coupon-items::-webkit-scrollbar-thumb,
        .coupon-history::-webkit-scrollbar-thumb {
            background: var(--gradient-primary);
            border-radius: 3px;
        }

        .coupon-items::-webkit-scrollbar-thumb:hover,
        .coupon-history::-webkit-scrollbar-thumb:hover {
            background: var(--primary-hover);
            box-shadow: var(--neon-glow);
        }

        .coupon-item {
            background: linear-gradient(145deg, rgba(40,40,40,0.9), rgba(60,60,60,0.8));
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255, 51, 51, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .coupon-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .coupon-item:hover::before {
            opacity: 1;
        }

        .coupon-item:hover {
            background: linear-gradient(145deg, rgba(0,255,136,0.1), rgba(76,175,80,0.05));
            border-color: var(--success-color);
            transform: translateX(8px);
            box-shadow: 0 6px 25px rgba(76, 175, 80, 0.2);
        }

        .coupon-event {
            font-size: 1rem;
            margin-bottom: 6px;
            color: var(--text-primary);
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 1px;
            line-height: 1.2;
        }

        .coupon-bet {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-transform: uppercase;
            opacity: 0.9;
        }

        .coupon-odds {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
        }

        .odds-number {
            font-size: 1.3rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
            text-shadow: none;
            letter-spacing: 1px;
        }

        .remove-bet {
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.3rem;
            transition: all 0.3s ease;
            font-weight: 400;
            background: none;
            border: none;
            padding: 6px;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-bet:hover {
            color: #ff4444;
            background: rgba(255, 68, 68, 0.2);
            transform: scale(1.2) rotate(90deg);
            box-shadow: 0 0 15px rgba(255, 68, 68, 0.4);
        }

        .coupon-empty {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            padding: 30px 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.7;
        }

        .coupon-total {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(255, 51, 51, 0.3);
            background: linear-gradient(145deg, rgba(40,40,40,0.8), rgba(60,60,60,0.7));
            border-radius: 12px;
            padding: 20px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 0;
        }

        .total-row:last-child {
            margin-bottom: 0;
            border-top: 1px solid rgba(255, 51, 51, 0.2);
            padding-top: 12px;
        }

        .total-label {
            font-size: 0.95rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .total-value {
            font-size: 1rem;
            color: var(--text-primary);
            font-weight: 400;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .stake-input {
            background: rgba(51, 51, 51, 0.8);
            border: 1px solid rgba(255, 51, 51, 0.3);
            border-radius: 8px;
            padding: 14px;
            color: var(--text-primary);
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-size: 1.1rem;
            width: 100%;
            margin-bottom: 16px;
            transition: all 0.3s;
            text-transform: uppercase;
            text-align: center;
        }

        .stake-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: var(--neon-glow);
            background: rgba(255, 51, 51, 0.1);
            transform: scale(1.02);
        }

        .place-bet-btn {
            background: var(--gradient-primary);
            color: #000;
            border: none;
            border-radius: 10px;
            padding: 16px;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-size: 1.2rem;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            text-shadow: none;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: bold;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(255, 51, 51, 0.3);
        }

        .place-bet-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .place-bet-btn:hover:not(:disabled)::before {
            left: 100%;
        }

        .place-bet-btn:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 6px 25px rgba(255, 51, 51, 0.4);
        }

        .place-bet-btn:disabled {
            background: rgba(85, 85, 85, 0.6);
            color: var(--text-primary);
            cursor: not-allowed;
            opacity: 0.6;
            transform: none;
            box-shadow: none;
        }

        /* **SUPPORT BUTTON** */
        .support-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 6px 25px rgba(255, 51, 51, 0.4);
            z-index: 80;
            transition: all 0.3s;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .support-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.4s, height 0.4s;
        }

        .support-button:hover::before {
            width: 120px;
            height: 120px;
        }

        .support-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(255, 51, 51, 0.6);
        }

        /* **MODALS - УЛУЧШЕННЫЕ** */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 200;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(8px);
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(145deg, rgba(20,20,20,0.95), rgba(40,40,40,0.9));
            border-radius: 16px;
            padding: 28px;
            max-width: 400px;
            width: 100%;
            color: var(--text-primary);
            max-height: 85vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 51, 51, 0.3);
            backdrop-filter: blur(15px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
            position: relative;
            animation: modalSlideIn 0.4s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            font-size: 1.8rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: none;
        }

        .modal-body {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .auth-input {
            background: rgba(51, 51, 51, 0.8);
            border: 1px solid rgba(255, 51, 51, 0.3);
            border-radius: 8px;
            padding: 14px;
            color: var(--text-primary);
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-size: 1.1rem;
            width: 100%;
            text-transform: uppercase;
            transition: all 0.3s;
        }

        .auth-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: var(--neon-glow);
            background: rgba(255, 51, 51, 0.1);
            transform: scale(1.02);
        }

        .modal-button, .modal-close {
            background: var(--gradient-primary);
            padding: 14px;
            border: none;
            border-radius: 8px;
            color: #000;
            font-size: 1.1rem;
            cursor: pointer;
            width: 100%;
            margin-bottom: 10px;
            transition: all 0.3s;
            text-transform: uppercase;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-weight: bold;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .modal-close {
            background: rgba(51, 51, 51, 0.8);
            color: var(--text-primary);
        }

        .modal-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--neon-glow);
        }

        .modal-close:hover {
            background: rgba(68, 68, 68, 0.9);
            box-shadow: 0 0 15px rgba(255, 51, 51, 0.3);
        }

        /* **SUPPORT CHAT - УЛУЧШЕННЫЙ** */
        .support-chat {
            height: 300px;
            overflow-y: auto;
            border: 1px solid rgba(255, 51, 51, 0.3);
            border-radius: 12px;
            padding: 16px;
            background: linear-gradient(145deg, rgba(30,30,30,0.8), rgba(50,50,50,0.6));
            margin-bottom: 16px;
            backdrop-filter: blur(10px);
        }

        .chat-message {
            margin-bottom: 14px;
            padding: 12px 16px;
            border-radius: 12px;
            max-width: 85%;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-size: 0.95rem;
            line-height: 1.4;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            animation: messageSlideIn 0.3s ease;
        }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .chat-message.user {
            background: var(--gradient-primary);
            margin-left: auto;
            text-align: right;
            color: #000;
            border-bottom-right-radius: 6px;
            box-shadow: 0 2px 10px rgba(255, 51, 51, 0.3);
        }

        .chat-message.support {
            background: linear-gradient(145deg, rgba(76,175,80,0.2), rgba(76,175,80,0.1));
            margin-right: auto;
            border-bottom-left-radius: 6px;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }

        .message-text {
            word-break: break-word;
            margin-bottom: 6px;
            font-weight: 400;
        }

        .message-time {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 4px;
            font-weight: 300;
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            background: rgba(51, 51, 51, 0.8);
            border: 1px solid rgba(255, 51, 51, 0.3);
            border-radius: 10px;
            padding: 14px;
            color: var(--text-primary);
            font-size: 1rem;
            resize: none;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            min-height: 55px;
            text-transform: uppercase;
            transition: all 0.3s;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: var(--neon-glow);
            background: rgba(255, 51, 51, 0.1);
            transform: scale(1.01);
        }

        .chat-send-btn {
            background: var(--gradient-primary);
            border: none;
            border-radius: 10px;
            color: #000;
            padding: 14px 20px;
            cursor: pointer;
            font-size: 1rem;
            align-self: flex-end;
            height: 55px;
            text-transform: uppercase;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            font-weight: bold;
            letter-spacing: 1px;
            transition: all 0.3s;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
            min-width: 100px;
        }

        .chat-send-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .chat-send-btn:hover:not(:disabled)::before {
            left: 100%;
        }

        .chat-send-btn:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: var(--neon-glow);
        }

        .chat-send-btn:disabled {
            background: rgba(85, 85, 85, 0.6);
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* **DEPOSIT METHODS** */
        .deposit-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 16px;
        }

        .deposit-method {
            background: rgba(51, 51, 51, 0.8);
            border-radius: 10px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(255, 51, 51, 0.3);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .deposit-method::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .deposit-method:hover::before {
            left: 100%;
        }

        .deposit-method.active {
            background: var(--gradient-primary);
            border-color: var(--primary-color);
            color: #000;
            transform: scale(1.05);
            box-shadow: var(--neon-glow);
        }

        .deposit-method:hover:not(.active) {
            background: rgba(255, 51, 51, 0.1);
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .deposit-method svg {
            width: 28px;
            height: 28px;
            fill: var(--text-primary);
            transition: fill 0.3s;
            filter: drop-shadow(0 0 5px rgba(255, 51, 51, 0.3));
        }

        .deposit-method.active svg {
            fill: #000;
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.5));
        }

        .deposit-amount {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .deposit-amount label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .deposit-amount input {
            background: rgba(51, 51, 51, 0.8);
            border: 1px solid rgba(255, 51, 51, 0.3);
            border-radius: 8px;
            padding: 14px;
            color: var(--text-primary);
            font-size: 1.1rem;
            text-transform: uppercase;
            text-align: center;
            transition: all 0.3s;
        }

        .deposit-amount input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: var(--neon-glow);
            background: rgba(255, 51, 51, 0.1);
        }

        /* **HISTORY ITEMS** */
        .history-item {
            background: linear-gradient(145deg, rgba(40,40,40,0.9), rgba(60,60,60,0.8));
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 12px;
            border: 1px solid rgba(255, 51, 51, 0.2);
            transition: all 0.3s;
            position: relative;
        }

        .history-item:hover {
            background: linear-gradient(145deg, rgba(0,255,136,0.1), rgba(76,175,80,0.05));
            border-color: var(--success-color);
            transform: translateX(5px);
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.2);
        }

        .history-date {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.8;
        }

        .history-event {
            font-size: 1rem;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 1px;
            line-height: 1.3;
        }

        .history-details {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.4;
            text-transform: uppercase;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 8px;
        }

        /* **GLOBAL NOTIFICATION** */
        #global-notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--gradient-primary);
            color: #000;
            padding: 14px 20px;
            border-radius: 10px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s ease;
            max-width: 300px;
            box-shadow: 0 8px 30px rgba(255, 51, 51, 0.4);
            transform: translateX(100%) scale(0.9);
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
            font-size: 0.95rem;
        }

        #global-notification.show {
            opacity: 1;
            transform: translateX(0) scale(1);
        }

        #global-notification.success {
            background: linear-gradient(45deg, var(--success-color), #66bb6a) !important;
            box-shadow: 0 8px 30px rgba(76, 175, 80, 0.4) !important;
        }

        #global-notification.error {
            background: linear-gradient(45deg, #ff4444, #ff0066) !important;
            animation: shake 0.5s ease-in-out;
            box-shadow: 0 8px 30px rgba(255, 68, 68, 0.4) !important;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0) scale(1); }
            25% { transform: translateX(-5px) scale(1); }
            75% { transform: translateX(5px) scale(1); }
        }

        /* **NOT IN TELEGRAM** */
        .not-in-telegram {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, rgba(0,0,0,0.95), rgba(18,18,18,0.9));
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 300;
            text-align: center;
            padding: 20px;
        }

        .not-in-telegram p {
            font-size: 1.6rem;
            margin-bottom: 25px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--text-primary);
            animation: fadeIn 1s ease;
        }

        .not-in-telegram a {
            background: var(--gradient-primary);
            padding: 16px 32px;
            border-radius: 12px;
            color: #000;
            text-decoration: none;
            font-size: 1.2rem;
            transition: all 0.3s;
            text-transform: uppercase;
            font-family: 'Bebas Neue', 'Bebas Neue Cyrillic', sans-serif;
            letter-spacing: 2px;
            font-weight: bold;
            position: relative;
            overflow: hidden;
            box-shadow: 0 6px 25px rgba(255, 51, 51, 0.4);
            animation: fadeIn 1s ease 0.3s both;
        }

        .not-in-telegram a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .not-in-telegram a:hover::before {
            left: 100%;
        }

        .not-in-telegram a:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(255, 51, 51, 0.5);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* **LIVE STATS PANEL** */
        #liveStats {
            background: linear-gradient(145deg, rgba(255,68,68,0.15), rgba(255,0,102,0.1));
            border: 2px solid rgba(255, 68, 68, 0.4);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            font-size: 0.9rem;
            animation: liveStatsPulse 2s infinite;
        }

        @keyframes liveStatsPulse {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(255, 68, 68, 0.3); 
                border-color: rgba(255, 68, 68, 0.4);
            }
            50% { 
                box-shadow: 0 0 30px rgba(255, 68, 68, 0.6); 
                border-color: rgba(255, 68, 68, 0.7);
            }
        }

        #liveStats > div:first-child {
            font-size: 1.3rem;
            color: #ff4444;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #liveStats > div:last-child {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 12px;
            text-align: center;
        }

        #liveStats > div:last-child > div {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 68, 68, 0.2);
        }

        #liveStats > div:last-child > div > div:first-child {
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-bottom: 4px;
            text-transform: uppercase;
        }

        #liveStats > div:last-child > div > div:last-child {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--primary-color);
            text-shadow: 0 0 5px rgba(255, 51, 51, 0.5);
        }

        /* **TEAM STATS PANEL** */
        #teamStats {
            background: linear-gradient(145deg, rgba(40,40,40,0.9), rgba(60,60,60,0.8));
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(255, 51, 51, 0.2);
            backdrop-filter: blur(10px);
        }

        #teamStats > div:first-child {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 18px;
            text-align: center;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(255, 51, 51, 0.3);
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
        }

        #teamStats > div:first-child::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 2px;
            background: var(--gradient-primary);
            box-shadow: 0 0 10px rgba(255, 51, 51, 0.4);
        }

        #teamStats > div:last-child {
            display: grid;
            grid-template-columns: 1fr 80px 1fr;
            gap: 20px;
            align-items: center;
            text-align: center;
        }

        .team-stat-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 51, 51, 0.2);
            position: relative;
        }

        .team-stat-box h4 {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .team-form {
            display: flex;
            justify-content: center;
            gap: 4px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .form-indicator {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            transition: all 0.3s;
            cursor: help;
            position: relative;
        }

        .form-indicator:hover {
            transform: scale(1.2);
            z-index: 10;
        }

        .form-win { background: linear-gradient(45deg, #4caf50, #66bb6a); }
        .form-draw { background: linear-gradient(45deg, #ffa500, #ffb74d); }
        .form-loss { background: linear-gradient(45deg, #ff4444, #ff0066); }

        .h2h-score {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            text-shadow: 0 0 15px rgba(255, 51, 51, 0.5);
            margin: 10px 0;
            letter-spacing: 2px;
        }

        .season-stats {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* **RESPONSIVE** */
        @media (max-width: 1000px) {
            .main-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .bet-coupon {
                position: fixed;
                top: 60px;
                left: 0;
                right: 0;
                bottom: 0;
                width: 100%;
                height: auto;
                max-height: none;
                border-radius: 0;
                transform: translateY(100%);
            }

            .bet-coupon.visible {
                transform: translateY(0);
            }

            .match-teams {
                gap: 20px;
            }

            .team-logo {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }

            .team-name {
                font-size: 1.3rem;
                max-width: 120px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 12px;
            }

            .tg-ready {
                padding-top: 60px;
            }

            header {
                padding: 8px 12px;
            }

            .header-left {
                gap: 8px;
            }

            .match-header {
                padding: 20px;
                gap: 15px;
            }

            .match-info {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .match-teams {
                flex-direction: column;
                gap: 20px;
            }

            .events-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .modal-content {
                margin: 16px;
                padding: 20px;
                max-width: none;
            }

            .chat-input-container {
                flex-direction: column;
            }

            .chat-send-btn {
                width: 100%;
            }

            #teamStats > div:last-child {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            #teamStats .team-stat-box {
                order: 3;
            }

            .h2h-score {
                order: 2;
            }
        }

        @media (max-width: 480px) {
            .section-title {
                font-size: 1.5rem;
                flex-direction: column;
                gap: 5px;
            }

            .event-item {
                padding: 15px;
                min-height: 70px;
            }

            .event-name {
                font-size: 0.9rem;
            }

            .event-odds {
                font-size: 1.3rem;
            }

            .coupon-title {
                font-size: 1.3rem;
            }

            .support-button {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }

        /* **QUICK BET TOAST** */
        .quick-bet-toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--gradient-primary);
            color: #000;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1rem;
            z-index: 95;
            opacity: 0;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
            white-space: nowrap;
            box-shadow: var(--neon-glow);
            font-weight: bold;
            letter-spacing: 1px;
        }

        .quick-bet-toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .quick-bet-toast.success {
            background: linear-gradient(45deg, var(--success-color), #66bb6a) !important;
            box-shadow: 0 0 25px rgba(76, 175, 80, 0.5) !important;
        }

        .quick-bet-toast.error {
            background: linear-gradient(45deg, #ff4444, #ff0066) !important;
            animation: shakeToast 0.5s ease-in-out;
            box-shadow: 0 0 25px rgba(255, 68, 68, 0.5) !important;
        }

        @keyframes shakeToast {
            0%, 100% { transform: translateX(-50%) translateY(-10px); }
            25% { transform: translateX(-55%) translateY(-10px); }
            75% { transform: translateX(-45%) translateY(-10px); }
        }

        /* **SWIPE HINT** */
        .swipe-hint {
            position: fixed;
            bottom: 90px;
            left: 20px;
            background: rgba(255, 51, 51, 0.1);
            color: var(--primary-color);
            padding: 10px 15px;
            border-radius: 25px;
            font-size: 0.85rem;
            z-index: 85;
            opacity: 0;
            transition: all 0.3s;
            border: 1px solid var(--primary-color);
            backdrop-filter: blur(10px);
            box-shadow: var(--neon-glow);
            white-space: nowrap;
        }

        .swipe-hint.show {
            opacity: 1;
            transform: translateY(0);
        }

        .swipe-hint i {
            margin-right: 5px;
            animation: swipeArrow 2s infinite;
        }

        @keyframes swipeArrow {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(5px); }
        }
    </style>
</head>
<body>
    <div id="preRegistration" class="tg-ready">
        <!-- HEADER -->
        <header>
            <div class="header-left">
                <img id="logo" src="/IMG/LOGO.svg" alt="EVILBET Logo" class="header-logo" onerror="this.src='https://via.placeholder.com/70x70/00ff88/121212?text=EVILBET'">
                <nav>
                    <ul>
                        <li><a href="index.html">ИГРАТЬ</a></li>
                        <li><a href="sport.html">СПОРТ</a></li>
                        <li><a href="referal.html">РЕФЕРАЛЫ</a></li>
                        <li><a href="live.html">ЛАЙВ</a></li>
                    </ul>
                </nav>
            </div>
            <div class="header-right">
                <div class="user-info" id="userInfoSection" style="display: none;">
                    <div class="balance-item">
                        <div class="balance-label">БАЛАНС</div>
                        <div class="balance-value" id="balanceDisplay">0.00$</div>
                    </div>
                    <div class="user-name" id="userName" onclick="openProfile()">Гость</div>
                </div>
                <div class="auth-buttons" id="authButtonsSection">
                    <button class="auth-btn login-btn" onclick="showModal('login')">Войти</button>
                    <button class="auth-btn register-btn" onclick="showModal('register')">Регистрация</button>
                </div>
                <div class="notifications">
                    <button class="notifications-btn" onclick="showNotifications()">
                        <i class="fas fa-bell"></i>
                    </button>
                    <div class="notification-count" id="notificationCount">0</div>
                </div>
                <a href="#" class="contact-btn" id="connectTgBtn" onclick="showModal('login')">Подключиться к Telegram</a>
                <button class="deposit-btn" onclick="openDepositModal()">Пополнить</button>
            </div>
        </header>

        <div class="main-container">
            <div class="events-column">
                <!-- **BACK BUTTON** -->
                <button class="back-button" onclick="window.history.back()">
                    <i class="fas fa-arrow-left"></i> Назад к матчам
                </button>

                <!-- **MATCH HEADER** -->
                <div class="match-header">
                    <div class="match-info">
                        <div class="match-time" id="matchTime">18:45</div>
                        <div class="match-league" id="matchLeague">Premier League</div>
                    </div>
                    <div class="match-teams">
                        <div class="team">
                            <div class="team-logo" id="teamHomeLogo">MU</div>
                            <div class="team-name" id="teamHomeName">Манчестер Юнайтед</div>
                        </div>
                        <div class="match-vs">VS</div>
                        <div class="team">
                            <div class="team-logo" id="teamAwayLogo">L</div>
                            <div class="team-name" id="teamAwayName">Ливерпуль</div>
                        </div>
                    </div>
                </div>

                <!-- **EVENTS SECTIONS** -->
                <div class="events-section">
                    <h2 class="section-title">
                        <i class="fas fa-star"></i> Основные события
                    </h2>
                    <div class="events-grid" id="mainEvents"></div>
                </div>

                <div class="events-section">
                    <h2 class="section-title">
                        <i class="fas fa-plus-minus"></i> Тоталы
                    </h2>
                    <div class="events-grid" id="totalEvents"></div>
                </div>

                <div class="events-section">
                    <h2 class="section-title">
                        <i class="fas fa-exchange-alt"></i> Форы
                    </h2>
                    <div class="events-grid" id="handicapEvents"></div>
                </div>

                <div class="events-section">
                    <h2 class="section-title">
                        <i class="fas fa-cogs"></i> Дополнительные события
                    </h2>
                    <div class="events-grid" id="additionalEvents"></div>
                </div>

                <!-- **STATS SECTION - НОВАЯ ФИШКА** -->
                <div class="events-section" id="statsSection">
                    <h2 class="section-title">
                        <i class="fas fa-chart-bar"></i> Статистика и анализ
                    </h2>
                    <div class="events-grid" id="statsEvents"></div>
                </div>
            </div>

            <!-- **BETS COUPON** -->
            <div class="bet-coupon" id="betCoupon">
                <button class="coupon-close" onclick="closeCoupon()">&times;</button>
                <div class="coupon-tabs">
                    <button class="coupon-tab active" data-tab="bets">Ставки</button>
                    <button class="coupon-tab" data-tab="history">История</button>
                </div>
                <div class="coupon-header">
                    <div class="coupon-title">КУПОН СТАВОК</div>
                    <button class="clear-coupon" onclick="clearCoupon()">Очистить</button>
                </div>
                <div class="coupon-items" id="couponItems">
                    <div class="coupon-empty">Выберите события для ставки</div>
                </div>
                <div class="coupon-history" id="couponHistory" style="display: none;">
                    <div class="coupon-empty">Нет ставок</div>
                </div>
                <div class="coupon-total">
                    <div class="total-row">
                        <div class="total-label">Сумма ставки:</div>
                        <input type="number" class="stake-input" id="stakeInput" placeholder="0.00" min="1" step="0.01" oninput="updateCoupon()">
                    </div>
                    <div class="total-row">
                        <div class="total-label">Коэффициент:</div>
                        <div class="total-value" id="totalOdds">1.00</div>
                    </div>
                    <div class="total-row">
                        <div class="total-label">Потенциальный выигрыш:</div>
                        <div class="total-value" id="potentialWin">0.00$</div>
                    </div>
                    <button class="place-bet-btn" id="placeBetBtn" onclick="placeBet()" disabled>СДЕЛАТЬ СТАВКУ</button>
                </div>
            </div>
        </div>

        <!-- **SUPPORT BUTTON** -->
        <div class="support-button" onclick="openSupportModal()">
            <i class="fas fa-headset"></i>
        </div>

        <!-- **QUICK BET TOAST** -->
        <div class="quick-bet-toast" id="quickBetToast"></div>

        <!-- **SWIPE HINT** -->
        <div class="swipe-hint" id="swipeHint">
            <i class="fas fa-hand-point-left"></i> Свайп для навигации
        </div>

        <!-- **NOT IN TELEGRAM** -->
        <div class="not-in-telegram" id="notInTelegram" style="display: none;">
            <p>⚠️ Пожалуйста, откройте в Telegram!</p>
            <a href="https://t.me/MyEvilBetBot" target="_blank">
                <i class="fab fa-telegram-plane"></i> Открыть в Telegram
            </a>
        </div>

        <!-- **MODALS** -->
        <div id="loginModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="hideModal('login')">&times;</span>
                <h2 class="modal-header">Вход через Telegram</h2>
                <div class="modal-body">
                    <p style="text-align: center; margin-bottom: 25px; color: var(--text-secondary);">
                        Для входа необходимо авторизоваться через Telegram
                    </p>
                    <button class="telegram-auth-btn" onclick="connectTelegram()">
                        <i class="fab fa-telegram-plane"></i>
                        Войти через Telegram
                    </button>
                </div>
                <button class="modal-close" onclick="hideModal('login')">Закрыть</button>
            </div>
        </div>

        <div id="registerModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="hideModal('register')">&times;</span>
                <h2 class="modal-header">Регистрация через Telegram</h2>
                <div class="modal-body">
                    <p style="text-align: center; margin-bottom: 25px; color: var(--text-secondary);">
                        Для регистрации необходимо подключить Telegram аккаунт
                    </p>
                    <button class="telegram-auth-btn" onclick="connectTelegram()">
                        <i class="fab fa-telegram-plane"></i>
                        Зарегистрироваться через Telegram
                    </button>
                </div>
                <button class="modal-close" onclick="hideModal('register')">Закрыть</button>
            </div>
        </div>

        <div id="profileModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeProfile()">&times;</span>
                <h2 class="modal-header">Профиль пользователя</h2>
                <div class="modal-body">
                    <div style="background: rgba(40,40,40,0.5); padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 1px solid rgba(255,51,51,0.2);">
                        <p style="margin-bottom: 10px;"><strong>👤 Имя:</strong> <span id="profileName" style="color: var(--primary-color);">Гость</span></p>
                        <p style="margin-bottom: 0;"><strong>💰 Баланс:</strong> <span id="profileBalance" style="color: var(--success-color); font-size: 1.2rem; font-weight: bold;">0.00$</span></p>
                    </div>
                    <button class="modal-button" onclick="openHistory()">
                        <i class="fas fa-history"></i> История ставок
                    </button>
                    <button class="modal-button" onclick="openDepositModal()">
                        <i class="fas fa-plus-circle"></i> Пополнить баланс
                    </button>
                    <button class="modal-button" style="background: #ff4444;" onclick="performLogout()">
                        <i class="fas fa-sign-out-alt"></i> Выйти
                    </button>
                </div>
                <button class="modal-close" onclick="closeProfile()">Закрыть</button>
            </div>
        </div>

        <div id="historyModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeHistory()">&times;</span>
                <h2 class="modal-header">История ставок</h2>
                <div id="betHistoryList" class="modal-body" style="max-height: 400px;"></div>
                <button class="modal-close" onclick="closeHistory()">Закрыть</button>
            </div>
        </div>

        <div id="depositModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeDepositModal()">&times;</span>
                <h2 class="modal-header">Пополнение баланса</h2>
                <div class="modal-body">
                    <div class="deposit-methods">
                        <div class="deposit-method active" data-method="card">
                            <svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8h16v10zm-2-1h-6v-2h6v2zM6 10h2v2H6v-2z"/></svg>
                            <span>Карта</span>
                        </div>
                        <div class="deposit-method" data-method="crypto">
                            <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg>
                            <span>Крипто</span>
                        </div>
                        <div class="deposit-method" data-method="qiwi">
                            <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3.5 15h-7c-.28 0-.5-.22-.5-.5v-5c0-.28.22-.5.5-.5h7c.28 0 .5.22.5.5v5c0 .28-.22.5-.5.5zm0-7h-7V7h7v3z"/></svg>
                            <span>Qiwi</span>
                        </div>
                    </div>
                    <div class="deposit-amount">
                        <label for="depositAmount">Сумма пополнения ($):</label>
                        <input type="number" id="depositAmount" placeholder="0.00" min="1" step="0.01">
                        <div style="display: flex; justify-content: space-around; margin-top: 8px; font-size: 0.8rem; color: var(--text-secondary);">
                            <button type="button" onclick="this.parentNode.parentNode.querySelector('input').value=10" style="background: none; border: none; color: var(--text-secondary); cursor: pointer;">10$</button>
                            <button type="button" onclick="this.parentNode.parentNode.querySelector('input').value=50" style="background: none; border: none; color: var(--text-secondary); cursor: pointer;">50$</button>
                            <button type="button" onclick="this.parentNode.parentNode.querySelector('input').value=100" style="background: none; border: none; color: var(--text-secondary); cursor: pointer;">100$</button>
                        </div>
                    </div>
                </div>
                <button class="modal-button" onclick="processDeposit()">
                    <i class="fas fa-credit-card"></i> Пополнить
                </button>
                <button class="modal-close" onclick="closeDepositModal()">Закрыть</button>
            </div>
        </div>

        <div id="supportModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeSupportModal()">&times;</span>
                <h2 class="modal-header">Чат с поддержкой</h2>
                <div class="modal-body">
                    <div class="support-chat" id="supportChat"></div>
                    <div class="chat-input-container">
                        <textarea class="chat-input" id="chatInput" placeholder="Опишите вашу проблему..." rows="2"></textarea>
                        <button class="chat-send-btn" id="sendSupportBtn" onclick="sendSupportMessage()">
                            <i class="fas fa-paper-plane"></i> Отправить
                        </button>
                    </div>
                </div>
                <button class="modal-close" onclick="closeSupportModal()">Закрыть чат</button>
            </div>
        </div>

        <div id="global-notification"></div>
    </div>

    <script>
        // Глобальные переменные
        const TelegramWebApp = window.Telegram?.WebApp;
        let isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        let balance = parseFloat(localStorage.getItem('balance')) || 0;
        let couponItems = JSON.parse(localStorage.getItem('couponItems')) || [];
        let betHistory = JSON.parse(localStorage.getItem('betHistory')) || [];
        let supportMessages = JSON.parse(localStorage.getItem('supportMessages')) || [];
        
        // Новые переменные для фишек
        let touchStartX = 0, touchStartY = 0;
        let currentSectionIndex = 0;
        let swipeHintShown = false;

        document.addEventListener('DOMContentLoaded', () => {
            console.log('🎯 Match Events - Enhanced v2.0 loaded');
            initApp();
        });

        function initApp() {
            console.log('🚀 Initializing Enhanced Match Events');
            
            if (TelegramWebApp) {
                TelegramWebApp.ready();
                TelegramWebApp.expand();
                applyTheme();
                document.getElementById('notInTelegram').style.display = 'none';
            } else {
                document.getElementById('notInTelegram').style.display = 'flex';
            }

            updateAuthUI();
            updateBalance();
            initCoupon();
            updateCouponHistory();
            initSupportChat();
            setupEventListeners();
            initSwipeNavigation();
            
            // **ЗАГРУЗКА ДАННЫХ МАТЧА**
            loadMatchData();
            
            // **ПОКАЗАТЬ ПОДСКАЗКУ О СВАЙПАХ**
            setTimeout(showSwipeHint, 1500);
        }

        function applyTheme() {
            if (TelegramWebApp?.themeParams) {
                const bgGradient = `linear-gradient(135deg, ${TelegramWebApp.themeParams.bg_color || '#121212'}, ${TelegramWebApp.themeParams.secondary_bg_color || '#1a1a1a'})`;
                document.body.style.background = bgGradient;
                document.querySelectorAll('.match-header, .events-section').forEach(el => {
                    el.style.background = bgGradient;
                });
            }
        }

        // **ЗАГРУЗКА И ОБРАБОТКА ДАННЫХ МАТЧА**
        function loadMatchData() {
            const matchData = JSON.parse(localStorage.getItem('selectedMatch'));
            if (!matchData) {
                console.error('❌ No match data found');
                showNotification('Данные о матче не найдены', 'error');
                setTimeout(() => window.location.href = 'sport.html', 2000);
                return;
            }

            console.log('📊 Loading match:', matchData.id, matchData.teamHome, 'vs', matchData.teamAway);
            
            // Заполняем основную информацию
            document.getElementById('matchTime').textContent = matchData.time || 'TBD';
            document.getElementById('matchLeague').textContent = matchData.league || 'Лига';
            document.getElementById('teamHomeName').textContent = matchData.teamHome || 'Команда 1';
            document.getElementById('teamAwayName').textContent = matchData.teamAway || 'Команда 2';
            document.getElementById('teamHomeLogo').textContent = matchData.teamHomeLogo || matchData.teamHome?.charAt(0) || 'T';
            document.getElementById('teamAwayLogo').textContent = matchData.teamAwayLogo || matchData.teamAway?.charAt(0) || 'T';

            // **LIVE СТАТУС И СЧЁТ**
            updateMatchStatus(matchData);

            // **ДОПОЛНИТЕЛЬНАЯ ИНФОРМАЦИЯ**
            addMatchInfo(matchData);

            // **ГЕНЕРАЦИЯ СОБЫТИЙ**
            generateEnhancedEvents(matchData);

            // **СТАТИСТИКА И АНАЛИЗ**
            generateStatsSection(matchData);

            // **LIVE СТАТИСТИКА ЕСЛИ АКТИВЕН МАТЧ**
            if (matchData.status === 'live' && matchData.liveStats) {
                updateLiveStats(matchData.liveStats);
                startLiveTimer(matchData);
            }

            TelegramWebApp?.HapticFeedback.impactOccurred('medium');
        }

        function updateMatchStatus(matchData) {
            const matchHeader = document.querySelector('.match-header');
            
            // Удаляем старые элементы
            const oldIndicator = document.getElementById('liveIndicator');
            const oldScore = document.getElementById('liveScore');
            const oldFinalScore = document.getElementById('finalScore');
            [oldIndicator, oldScore, oldFinalScore].forEach(el => el?.remove());

            if (matchData.status === 'live' && matchData.currentScore) {
                // LIVE ИНДИКАТОР
                const liveIndicator = document.createElement('div');
                liveIndicator.id = 'liveIndicator';
                liveIndicator.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <div style="width: 8px; height: 8px; background: #4caf50; border-radius: 50%; animation: liveDot 1s infinite;"></div>
                        LIVE ${matchData.currentMinute || 45}'
                    </div>
                `;
                liveIndicator.style.cssText = `
                    position: absolute; top: 20px; right: 20px; 
                    background: linear-gradient(45deg, #ff4444, #ff0066); 
                    color: white; padding: 8px 14px; border-radius: 20px; 
                    font-size: 0.85rem; font-weight: bold; z-index: 10;
                    box-shadow: 0 0 20px rgba(255, 68, 68, 0.6);
                    animation: livePulse 1.5s infinite;
                `;
                matchHeader.appendChild(liveIndicator);

                // ЖИВОЙ СЧЁТ
                const scoreDisplay = document.createElement('div');
                scoreDisplay.id = 'liveScore';
                scoreDisplay.textContent = matchData.currentScore;
                scoreDisplay.style.cssText = `
                    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
                    font-size: 4rem; font-weight: bold; color: #ff4444; 
                    text-shadow: 3px 3px 6px rgba(0,0,0,0.8); z-index: 5;
                    animation: scorePulse 2s infinite;
                `;
                matchHeader.appendChild(scoreDisplay);

                

            } else if (matchData.status === 'finished' && matchData.finalScore) {
                // ФИНАЛЬНЫЙ СЧЁТ
                const finalScore = document.createElement('div');
                finalScore.id = 'finalScore';
                finalScore.innerHTML = `
                    <div style="font-size: 2rem; color: var(--success-color); margin-bottom: 5px; font-weight: bold;">FT</div>
                    <div style="font-size: 3rem; font-weight: bold; color: var(--success-color); text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">${matchData.finalScore}</div>
                `;
                finalScore.style.cssText = `
                    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
                    text-align: center; z-index: 5;
                `;
                matchHeader.appendChild(finalScore);
            }
        }

        function addMatchInfo(matchData) {
            const matchHeader = document.querySelector('.match-header');
            const oldMatchInfo = document.getElementById('matchInfo');
            oldMatchInfo?.remove();

            const matchInfo = document.createElement('div');
            matchInfo.id = 'matchInfo';
            matchInfo.style.cssText = `
                background: linear-gradient(145deg, rgba(40,40,40,0.8), rgba(60,60,60,0.7));
                border-radius: 12px; padding: 15px; margin: 15px 0;
                font-size: 0.9rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 12px; text-align: center; border: 1px solid rgba(255, 51, 51, 0.2);
                backdrop-filter: blur(10px); position: relative; z-index: 2;
            `;

            const infoItems = [
                { icon: 'fas fa-map-marker-alt', text: matchData.matchInfo?.venue || 'Неизвестно', color: '#4caf50' },
                { icon: 'fas fa-cloud-sun', text: matchData.matchInfo?.weather || '☀️ 20°C', color: '#ffa500' },
                { icon: 'fas fa-user-tie', text: matchData.matchInfo?.referee || 'Судья', color: '#2196f3' },
                { icon: 'fas fa-tv', text: matchData.matchInfo?.tvBroadcast || 'Прямая трансляция', color: '#9c27b0' }
            ];

            matchInfo.innerHTML = infoItems.map(item => `
                <div style="display: flex; flex-direction: column; align-items: center; gap: 6px; color: var(--text-secondary);">
                    <i class="${item.icon}" style="font-size: 1.2rem; color: ${item.color}; text-shadow: 0 0 8px ${item.color}20;"></i>
                    <span style="font-size: 0.8rem; letter-spacing: 0.5px;">${item.text}</span>
                </div>
            `).join('');

            matchHeader.parentNode.insertBefore(matchInfo, matchHeader.nextSibling);
        }

        // **НОВЫЕ КРУТЫЕ ФИШКИ ДЛЯ СТАТИСТИКИ**
        function generateStatsSection(matchData) {
            const statsContainer = document.getElementById('statsEvents');
            statsContainer.innerHTML = '';

            // **1. ПРОГНОЗЫ С ПРОГРЕСС-БАРАМИ**
            if (matchData.predictions) {
                const predictionItem = createStatItem('Прогнозы на матч', `
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="font-size: 1rem; color: var(--text-secondary);">П1: ${matchData.predictions.winProbability?.home || 42}%</span>
                            <span style="font-size: 1.1rem; color: var(--primary-color); font-weight: bold;">${matchData.teamHome}</span>
                        </div>
                        <div class="progress-bar" data-value="${matchData.predictions.winProbability?.home || 42}" style="background: linear-gradient(to right, var(--success-color) ${matchData.predictions.winProbability?.home || 42}%, rgba(255,255,255,0.1) ${matchData.predictions.winProbability?.home || 42}%);"></div>
                        
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="font-size: 1rem; color: var(--text-secondary);">Ничья: ${matchData.predictions.winProbability?.draw || 28}%</span>
                            <span style="font-size: 1.1rem; color: #ffa500; font-weight: bold;">X</span>
                        </div>
                        <div class="progress-bar" data-value="${matchData.predictions.winProbability?.draw || 28}" style="background: linear-gradient(to right, #ffa500 ${matchData.predictions.winProbability?.draw || 28}%, rgba(255,255,255,0.1) ${matchData.predictions.winProbability?.draw || 28}%);"></div>
                        
                        <div style="display: flex; align-items: center; justify-content: space-between;">
                            <span style="font-size: 1rem; color: var(--text-secondary);">П2: ${matchData.predictions.winProbability?.away || 30}%</span>
                            <span style="font-size: 1.1rem; color: var(--primary-color); font-weight: bold;">${matchData.teamAway}</span>
                        </div>
                        <div class="progress-bar" data-value="${matchData.predictions.winProbability?.away || 30}" style="background: linear-gradient(to right, var(--primary-color) ${matchData.predictions.winProbability?.away || 30}%, rgba(255,255,255,0.1) ${matchData.predictions.winProbability?.away || 30}%);"></div>
                    </div>
                `);
                statsContainer.appendChild(predictionItem);
            }

            // **2. H2H С АНИМАЦИЕЙ**
            if (matchData.headToHead) {
                const h2hItem = createStatItem('История встреч', `
                    <div style="position: relative; height: 120px;">
                        <div style="position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 2px; height: 100%; background: linear-gradient(to bottom, transparent, var(--primary-color), transparent); z-index: 1;"></div>
                        <div style="display: flex; justify-content: space-between; align-items: center; height: 100%; z-index: 2; position: relative;">
                            <div style="text-align: center;">
                                <div style="width: 50px; height: 50px; background: linear-gradient(45deg, var(--success-color), #66bb6a); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 8px; font-weight: bold; color: white; box-shadow: 0 0 15px rgba(76,175,80,0.5);">${matchData.headToHead.homeWins || 2}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">${matchData.teamHome}</div>
                            </div>
                            <div style="font-size: 1.8rem; font-weight: bold; color: var(--primary-color); text-shadow: 0 0 10px rgba(255,51,51,0.5); min-width: 60px; text-align: center;">
                                ${matchData.headToHead.homeWins || 2}-${matchData.headToHead.draws || 1}-${matchData.headToHead.awayWins || 2}
                            </div>
                            <div style="text-align: center;">
                                <div style="width: 50px; height: 50px; background: linear-gradient(45deg, var(--primary-color), #ff0066); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 8px; font-weight: bold; color: white; box-shadow: 0 0 15px rgba(255,51,51,0.5);">${matchData.headToHead.awayWins || 2}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">${matchData.teamAway}</div>
                            </div>
                        </div>
                        ${matchData.headToHead.recentH2H ? `
                            <div style="position: absolute; bottom: -30px; left: 50%; transform: translateX(-50%); background: rgba(40,40,40,0.9); padding: 8px 12px; border-radius: 8px; border: 1px solid rgba(255,51,51,0.2); font-size: 0.7rem; color: var(--text-secondary); white-space: nowrap;">
                                Последние 4 встречи
                            </div>
                        ` : ''}
                    </div>
                `);
                statsContainer.appendChild(h2hItem);
            }

            // **3. ФОРМА КОМАНД С ТУЛТИПАМИ**
            const formItem = createStatItem('Форма команд', `
                <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center; text-align: center;">
                    <div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 10px;">${matchData.teamHome || 'Команда 1'}</div>
                        <div class="team-form" style="display: flex; justify-content: center; gap: 4px; margin-bottom: 8px;">
                            ${generateFormIndicators(matchData.homeTeamStats?.form || ['W','D','W','L','W'], matchData.homeTeamStats?.recentMatches)}
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">5 последних матчей</div>
                    </div>
                    <div style="font-size: 2rem; color: var(--primary-color); font-weight: bold; text-shadow: 0 0 15px rgba(255,51,51,0.5);">VS</div>
                    <div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 10px;">${matchData.teamAway || 'Команда 2'}</div>
                        <div class="team-form" style="display: flex; justify-content: center; gap: 4px; margin-bottom: 8px;">
                            ${generateFormIndicators(matchData.awayTeamStats?.form || ['W','W','L','D','W'], matchData.awayTeamStats?.recentMatches)}
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">5 последних матчей</div>
                    </div>
                </div>
            `);
            statsContainer.appendChild(formItem);

            // **4. ОЖИДАЕМЫЕ ГОЛЫ**
            if (matchData.predictions?.expectedGoals) {
                const goalsItem = createStatItem('Ожидаемые голы (xG)', `
                    <div style="display: flex; align-items: center; justify-content: space-around; gap: 20px; flex-wrap: wrap;">
                        <div style="text-align: center; flex: 1;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: var(--success-color); margin-bottom: 8px; text-shadow: 0 0 10px rgba(76,175,80,0.5);">${matchData.predictions.expectedGoals.home || 1.4}</div>
                            <div style="font-size: 0.9rem; color: var(--text-secondary);">${matchData.teamHome}</div>
                        </div>
                        <div style="font-size: 1.5rem; color: var(--text-secondary); font-weight: bold; transform: rotate(-90deg);">VS</div>
                        <div style="text-align: center; flex: 1;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: var(--primary-color); margin-bottom: 8px; text-shadow: 0 0 10px rgba(255,51,51,0.5);">${matchData.predictions.expectedGoals.away || 1.2}</div>
                            <div style="font-size: 0.9rem; color: var(--text-secondary);">${matchData.teamAway}</div>
                        </div>
                    </div>
                `);
                statsContainer.appendChild(goalsItem);
            }

            // **5. РЕКОМЕНДУЕМАЯ СТАВКА**
            if (matchData.predictions?.recommendedBet) {
                const recBet = matchData.predictions.recommendedBet;
                const recItem = createStatItem('Рекомендация AI', `
                    <div style="text-align: center; padding: 15px;">
                        <div style="font-size: 1.1rem; color: var(--success-color); margin-bottom: 10px; font-weight: bold;">
                            🤖 Рекомендуем: ${recBet.type?.toUpperCase() || 'OVER 2.5'}
                        </div>
                        <div style="font-size: 2.5rem; font-weight: bold; color: var(--primary-color); margin-bottom: 8px; text-shadow: 0 0 15px rgba(255,51,51,0.5);">
                            ${recBet.odds?.toFixed(2) || 1.85}
                        </div>
                        <div style="display: inline-flex; align-items: center; gap: 8px; background: rgba(76,175,80,0.2); padding: 6px 12px; border-radius: 20px; font-size: 0.85rem; color: var(--success-color); border: 1px solid rgba(76,175,80,0.3);">
                            <div style="width: 8px; height: 8px; background: var(--success-color); border-radius: 50%;"></div>
                            Уверенность: ${recBet.confidence || 65}%
                        </div>
                    </div>
                `);
                statsContainer.appendChild(recItem);
            }

            // АНИМАЦИЯ ПРОГРЕСС-БАРОВ
            setTimeout(() => {
                document.querySelectorAll('.progress-bar').forEach(bar => {
                    const value = parseInt(bar.dataset.value);
                    bar.style.width = `${value}%`;
                    bar.style.transition = 'width 1.5s ease-out';
                });
            }, 500);
        }

        function createStatItem(title, content) {
            const item = document.createElement('div');
            item.className = 'event-item stat-item';
            item.innerHTML = `
                <div class="event-name" style="margin-bottom: 15px; font-size: 1.1rem; font-weight: bold; color: var(--primary-color); text-shadow: 0 0 10px rgba(255,51,51,0.3);">${title}</div>
                <div style="width: 100%;">${content}</div>
            `;
            return item;
        }

        function generateFormIndicators(form, recentMatches) {
            return form.slice(0, 5).map((result, index) => {
                const colorClass = result === 'W' ? 'form-win' : result === 'D' ? 'form-draw' : 'form-loss';
                const matchInfo = recentMatches?.[index] ? 
                    `${recentMatches[index].score} (${recentMatches[index].opponent})` : 
                    'Неизвестно';
                
                return `
                    <div class="form-indicator ${colorClass}" 
                         title="${result} - ${matchInfo}" 
                         style="position: relative;">
                        ${result}
                        <div class="form-tooltip" style="
                            position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%);
                            background: rgba(0,0,0,0.9); color: white; padding: 8px 12px; 
                            border-radius: 6px; font-size: 0.7rem; white-space: nowrap;
                            opacity: 0; pointer-events: none; transition: opacity 0.3s;
                            z-index: 100; margin-bottom: 5px; border: 1px solid var(--primary-color);
                        ">
                            ${matchInfo}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // **ОБНОВЛЁННАЯ ГЕНЕРАЦИЯ СОБЫТИЙ**
        function generateEnhancedEvents(matchData) {
            console.log('🎲 Generating enhanced events for:', matchData.id);
            const eventName = `${matchData.teamHome} - ${matchData.teamAway}`;
            const matchId = matchData.id || 'default_match';

            // ОСНОВНЫЕ СОБЫТИЯ
            const mainEvents = [
                { name: eventName, bet: 'П1 (Победа хозяев)', odds: matchData.mainOdds?.p1 || 2.10, matchId, category: 'main' },
                { name: eventName, bet: 'X (Ничья)', odds: matchData.mainOdds?.x || 3.40, matchId, category: 'main' },
                { name: eventName, bet: 'П2 (Победа гостей)', odds: matchData.mainOdds?.p2 || 3.20, matchId, category: 'main' },
                { name: eventName, bet: 'Обе забьют: Да', odds: matchData.additionalMarkets?.bothTeamsToScore?.yes || 1.72, matchId, category: 'main' },
                { name: eventName, bet: 'Обе забьют: Нет', odds: matchData.additionalMarkets?.bothTeamsToScore?.no || 2.08, matchId, category: 'main' },
                { name: eventName, bet: '1-й гол: Хозяева', odds: 1.65, matchId, category: 'main' },
                { name: eventName, bet: '1-й гол: Гости', odds: 2.15, matchId, category: 'main' }
            ];

            // ТОТАЛЫ
            const totalEvents = [
                { name: eventName, bet: 'Тотал больше 0.5', odds: 1.02, matchId, category: 'total' },
                { name: eventName, bet: 'Тотал меньше 0.5', odds: 10.00, matchId, category: 'total' },
                { name: eventName, bet: 'Тотал больше 1.5', odds: 1.25, matchId, category: 'total' },
                { name: eventName, bet: 'Тотал меньше 1.5', odds: 3.75, matchId, category: 'total' },
                { name: eventName, bet: 'Тотал больше 2.5', odds: matchData.totalOdds?.over25 || 1.85, matchId, category: 'total' },
                { name: eventName, bet: 'Тотал меньше 2.5', odds: matchData.totalOdds?.under25 || 1.95, matchId, category: 'total' },
                { name: eventName, bet: 'Тотал больше 3.5', odds: 2.80, matchId, category: 'total' },
                { name: eventName, bet: 'Тотал меньше 3.5', odds: 1.40, matchId, category: 'total' }
            ];

            // ФОРЫ
            const handicapEvents = [
                { name: eventName, bet: 'Фора 1 (0)', odds: matchData.handicapOdds?.home0 || 1.90, matchId, category: 'handicap' },
                { name: eventName, bet: 'Фора 2 (0)', odds: matchData.handicapOdds?.away0 || 1.90, matchId, category: 'handicap' },
                { name: eventName, bet: 'Фора 1 (-1)', odds: 3.10, matchId, category: 'handicap' },
                { name: eventName, bet: 'Фора 2 (+1)', odds: 1.40, matchId, category: 'handicap' },
                { name: eventName, bet: 'Фора 1 (+1)', odds: 1.25, matchId, category: 'handicap' },
                { name: eventName, bet: 'Фора 2 (-1)', odds: 3.75, matchId, category: 'handicap' },
                { name: eventName, bet: 'Фора 1 (-0.5)', odds: 2.40, matchId, category: 'handicap' },
                { name: eventName, bet: 'Фора 2 (+0.5)', odds: 1.60, matchId, category: 'handicap' }
            ];

            // ДОПОЛНИТЕЛЬНЫЕ СОБЫТИЯ
            const additionalEvents = [
                // Точный счёт
                ...(matchData.additionalMarkets?.correctScore ? 
                    Object.entries(matchData.additionalMarkets.correctScore)
                        .slice(0, 6)
                        .map(([score, odds]) => ({
                            name: eventName, 
                            bet: `Точный счёт ${score}`, 
                            odds: odds, 
                            matchId, 
                            category: 'additional'
                        })) : [
                            { name: eventName, bet: 'Точный счёт 1:0', odds: 6.50, matchId, category: 'additional' },
                            { name: eventName, bet: 'Точный счёт 2:1', odds: 8.00, matchId, category: 'additional' },
                            { name: eventName, bet: 'Точный счёт 1:1', odds: 6.00, matchId, category: 'additional' },
                            { name: eventName, bet: 'Точный счёт 0:1', odds: 7.50, matchId, category: 'additional' },
                            { name: eventName, bet: 'Точный счёт 2:0', odds: 9.00, matchId, category: 'additional' },
                            { name: eventName, bet: 'Точный счёт 0:2', odds: 10.00, matchId, category: 'additional' }
                        ]
                ),
                // Полувремя/Основное время
                ...(matchData.additionalMarkets?.halftimeResult ? 
                    Object.entries(matchData.additionalMarkets.halftimeResult)
                        .map(([result, odds]) => ({
                            name: eventName, 
                            bet: `Полувремя/Время: ${result === 'home' ? 'П1/П1' : result === 'draw' ? 'X/X' : 'П2/П2'}`, 
                            odds: odds * 1.5, 
                            matchId, 
                            category: 'additional'
                        })) : [
                            { name: eventName, bet: 'Полувремя/Время: П1/П1', odds: 4.50, matchId, category: 'additional' },
                            { name: eventName, bet: 'Полувремя/Время: X/X', odds: 3.20, matchId, category: 'additional' },
                            { name: eventName, bet: 'Полувремя/Время: П2/П2', odds: 5.80, matchId, category: 'additional' }
                        ]
                ),
                // Дополнительные рынки
                { name: eventName, bet: 'Кто забьет первым: Хозяева', odds: 1.65, matchId, category: 'additional' },
                { name: eventName, bet: 'Кто забьет первым: Гости', odds: 2.15, matchId, category: 'additional' },
                { name: eventName, bet: 'Кто забьет последним: Хозяева', odds: 1.85, matchId, category: 'additional' },
                { name: eventName, bet: 'Кто забьет последним: Гости', odds: 1.95, matchId, category: 'additional' }
            ];

            // Заполняем секции
            fillEvents('mainEvents', mainEvents.slice(0, 4));
            fillEvents('totalEvents', totalEvents.slice(0, 6));
            fillEvents('handicapEvents', handicapEvents.slice(0, 6));
            fillEvents('additionalEvents', additionalEvents.slice(0, 8));

            // Обновляем выделение уже выбранных ставок
            setTimeout(() => highlightSelectedEvents(), 100);
        }

        // **ОБНОВЛЁННАЯ ФУНКЦИЯ ЗАПОЛНЕНИЯ СОБЫТИЙ**
        function fillEvents(containerId, events) {
            const container = document.getElementById(containerId);
            if (!container) return;

            container.innerHTML = '';

            events.forEach((event, index) => {
                const eventElement = document.createElement('div');
                eventElement.className = `event-item ${event.category}`;
                eventElement.dataset.event = event.name;
                eventElement.dataset.bet = event.bet;
                eventElement.dataset.odds = event.odds;
                eventElement.dataset.matchId = event.matchId;
                eventElement.dataset.index = index;

                // Проверяем, выбрано ли событие
                const isSelected = couponItems.some(item => 
                    item.event === event.name && 
                    item.bet === event.bet && 
                    item.matchId === event.matchId
                );

                if (isSelected) {
                    eventElement.classList.add('selected');
                }

                // Специальный стиль для статистики
                if (event.isStat) {
                    eventElement.classList.add('stat-item');
                    eventElement.style.cursor = 'default';
                }

                eventElement.innerHTML = `
                    <div class="event-name">${event.bet}</div>
                    ${!event.isStat ? `<div class="event-odds">${event.odds.toFixed(2)}</div>` : ''}
                `;

                // Обработчик клика
                if (!event.isStat) {
                    eventElement.addEventListener('click', (e) => handleEventClick(e, event));
                    eventElement.addEventListener('touchend', (e) => handleEventClick(e, event));
                }

                container.appendChild(eventElement);
            });

            // Анимация появления
            setTimeout(() => {
                container.querySelectorAll('.event-item').forEach((item, index) => {
                    setTimeout(() => {
                        item.style.opacity = '1';
                        item.style.transform = 'translateY(0)';
                    }, index * 100);
                });
            }, 100);
        }

        // **ОБРАБОТЧИК КЛИКА ПО СОБЫТИЮ**
        function handleEventClick(e, event) {
            e.stopPropagation();
            e.preventDefault();

            const eventElement = e.currentTarget;
            const isSelected = eventElement.classList.contains('selected');

            if (isSelected) {
                // Удаляем из купона
                removeFromCouponByEvent(event.name, event.bet, event.matchId);
                eventElement.classList.remove('selected');
                createRipple(eventElement, '#ff4444');
                showQuickBetToast(`❌ ${event.bet} удалено из купона`, 'error');
                TelegramWebApp?.HapticFeedback.impactOccurred('light');
            } else {
                // **ПРОВЕРКА ЛИМИТА 2 СТАВКИ НА СОБЫТИЕ**
                const eventBets = couponItems.filter(item => item.event === event.name);
                if (eventBets.length >= 2) {
                    showQuickBetToast('⚠️ Максимум 2 ставки на событие!', 'error');
                    eventElement.style.background = 'rgba(255, 68, 68, 0.2)';
                    setTimeout(() => eventElement.style.background = '', 500);
                    TelegramWebApp?.HapticFeedback.notificationOccurred('error');
                    return;
                }

                // Добавляем в купон
                const added = addToCoupon(event.name, event.bet, event.odds, event.matchId);
                if (added) {
                    eventElement.classList.add('selected');
                    createRipple(eventElement, '#4caf50');
                    showQuickBetToast(`✓ ${event.bet} (${event.odds.toFixed(2)}) добавлено!`, 'success');
                    TelegramWebApp?.HapticFeedback.impactOccurred('success');
                }
            }

            updateCoupon();
            highlightSelectedEvents();
        }

        // **RIPPLE ЭФФЕКТ**
        function createRipple(element, color = 'rgba(255, 255, 255, 0.4)') {
            const ripple = document.createElement('span');
            const rect = element.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = e.clientX - rect.left - size / 2;
            const y = e.clientY - rect.top - size / 2;

            ripple.style.cssText = `
                position: absolute;
                width: ${size}px;
                height: ${size}px;
                left: ${x}px;
                top: ${y}px;
                background: ${color};
                border-radius: 50%;
                transform: scale(0);
                animation: rippleEffect 0.6s linear;
                pointer-events: none;
                z-index: 10;
            `;

            element.style.position = 'relative';
            element.appendChild(ripple);

            setTimeout(() => ripple.remove(), 600);
        }

        // **ОБНОВЛЕНИЕ ВЫДЕЛЕННЫХ СОБЫТИЙ**
        function highlightSelectedEvents() {
            document.querySelectorAll('.event-item:not(.stat-item)').forEach(item => {
                const eventName = item.dataset.event;
                const bet = item.dataset.bet;
                const matchId = item.dataset.matchId;

                const isSelected = couponItems.some(c => 
                    c.event === eventName && c.bet === bet && c.matchId === matchId
                );

                item.classList.toggle('selected', isSelected);
            });
        }

        // **ОСТАЛЬНЫЕ ФУНКЦИИ - АНАЛОГИЧНЫ sport.html**
        function connectTelegram() {
            if (TelegramWebApp?.initDataUnsafe?.user) {
                const user = TelegramWebApp.initDataUnsafe.user;
                isLoggedIn = true;
                currentUser = {
                    id: user.id,
                    username: user.username || user.first_name || 'User_' + user.id,
                    firstName: user.first_name || '',
                    lastName: user.last_name || ''
                };
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                updateAuthUI();
                updateBalance();
                showQuickBetToast(`👋 Добро пожаловать, ${currentUser.username}!`, 'success');
                hideModal('login');
                hideModal('register');
                TelegramWebApp.HapticFeedback.impactOccurred('medium');
                document.getElementById('connectTgBtn').style.display = 'none';
            } else {
                showQuickBetToast('❌ Не удалось авторизоваться', 'error');
            }
        }

        function updateAuthUI() {
            const userInfoSection = document.getElementById('userInfoSection');
            const authButtonsSection = document.getElementById('authButtonsSection');
            const userNameElement = document.getElementById('userName');
            const connectBtn = document.getElementById('connectTgBtn');

            if (isLoggedIn && currentUser) {
                userInfoSection.style.display = 'flex';
                authButtonsSection.style.display = 'none';
                userNameElement.textContent = currentUser.username;
                document.getElementById('profileName').textContent = currentUser.username;
                connectBtn.style.display = 'none';
            } else {
                userInfoSection.style.display = 'none';
                authButtonsSection.style.display = 'flex';
                connectBtn.style.display = 'inline-block';
            }
        }

        function addToCoupon(eventName, bet, odds, matchId) {
            const existingIndex = couponItems.findIndex(item => 
                item.event === eventName && item.bet === bet && item.matchId === matchId
            );

            if (existingIndex !== -1) {
                couponItems.splice(existingIndex, 1);
                return false;
            }

            // Проверка лимита 2 ставки на событие
            const eventBets = couponItems.filter(item => item.event === eventName);
            if (eventBets.length >= 2) {
                return false;
            }

            couponItems.push({ event: eventName, bet, odds: parseFloat(odds), matchId });
            localStorage.setItem('couponItems', JSON.stringify(couponItems));
            return true;
        }

        function removeFromCouponByEvent(eventName, betType, matchId) {
            couponItems = couponItems.filter(item => 
                !(item.event === eventName && item.bet === betType && item.matchId === matchId)
            );
            localStorage.setItem('couponItems', JSON.stringify(couponItems));
        }

        function removeFromCoupon(index) {
            if (couponItems[index]) {
                const removedItem = couponItems[index];
                couponItems.splice(index, 1);
                localStorage.setItem('couponItems', JSON.stringify(couponItems));
                
                // Обновляем выделение
                highlightSelectedEvents();
                
                showQuickBetToast(`🗑️ ${removedItem.bet} удалено`, 'error');
                TelegramWebApp?.HapticFeedback.impactOccurred('light');
                
                if (couponItems.length === 0) {
                    document.getElementById('betCoupon').classList.remove('visible');
                }
            }
            updateCoupon();
        }

        function clearCoupon() {
            couponItems = [];
            localStorage.setItem('couponItems', JSON.stringify(couponItems));
            document.getElementById('betCoupon').classList.remove('visible');
            highlightSelectedEvents();
            showQuickBetToast('🧹 Купон очищен', 'error');
            TelegramWebApp?.HapticFeedback.notificationOccurred('error');
            updateCoupon();
        }

        function closeCoupon() {
            document.getElementById('betCoupon').classList.remove('visible');
            TelegramWebApp?.HapticFeedback.impactOccurred('light');
        }

        function updateCoupon() {
            const couponItemsEl = document.getElementById('couponItems');
            const totalOddsEl = document.getElementById('totalOdds');
            const potentialWinEl = document.getElementById('potentialWin');
            const placeBetBtn = document.getElementById('placeBetBtn');
            const stakeInput = document.getElementById('stakeInput');

            couponItemsEl.innerHTML = '';
            if (couponItems.length === 0) {
                couponItemsEl.innerHTML = '<div class="coupon-empty">👆 Нажмите на коэффициент, чтобы добавить в купон</div>';
                totalOddsEl.textContent = '1.00';
                potentialWinEl.textContent = '0.00$';
                placeBetBtn.disabled = true;
                return;
            }

            couponItems.forEach((item, index) => {
                const couponItem = document.createElement('div');
                couponItem.className = 'coupon-item';
                couponItem.innerHTML = `
                    <div class="coupon-event">${item.event}</div>
                    <div class="coupon-bet">${item.bet}</div>
                    <div class="coupon-odds">
                        <div class="odds-number">${item.odds.toFixed(2)}</div>
                        <button class="remove-bet" onclick="removeFromCoupon(${index})" title="Удалить ставку">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                couponItemsEl.appendChild(couponItem);
            });

            const totalOdds = couponItems.reduce((acc, item) => acc * item.odds, 1).toFixed(2);
            const stake = parseFloat(stakeInput.value) || 0;
            const potentialWin = (stake * totalOdds).toFixed(2);
            
            totalOddsEl.textContent = totalOdds;
            potentialWinEl.textContent = potentialWin + '$';
            placeBetBtn.disabled = !isLoggedIn || stake <= 0 || stake > balance;

            if (couponItems.length > 0) {
                document.getElementById('betCoupon').classList.add('visible');
            }
        }

        function placeBet() {
            if (!isLoggedIn) {
                showModal('login');
                showQuickBetToast('🔐 Войдите для оформления ставки', 'error');
                return;
            }

            const stake = parseFloat(document.getElementById('stakeInput').value);
            if (stake <= 0 || isNaN(stake)) {
                showQuickBetToast('💰 Введите сумму ставки', 'error');
                return;
            }

            if (stake > balance) {
                showQuickBetToast('⚠️ Недостаточно средств', 'error');
                return;
            }

            const totalOdds = couponItems.reduce((acc, item) => acc * item.odds, 1).toFixed(2);
            const potentialWin = (stake * totalOdds).toFixed(2);

            const bet = {
                id: Date.now(),
                date: new Date().toLocaleString('ru-RU'),
                events: couponItems.map(item => `${item.event} - ${item.bet} (${item.odds.toFixed(2)})`),
                bet: couponItems.map(item => item.bet).join(', '),
                odds: totalOdds,
                stake: stake,
                potentialWin: potentialWin,
                status: 'pending'
            };

            betHistory.push(bet);
            localStorage.setItem('betHistory', JSON.stringify(betHistory));
            balance -= stake;
            localStorage.setItem('balance', balance);
            
            updateBalance();
            showQuickBetToast(`✅ Ставка на ${stake}$ принята! Выигрыш: ${potentialWin}$`, 'success');
            clearCoupon();
            updateCouponHistory();
            TelegramWebApp?.HapticFeedback.notificationOccurred('success');

            // Анимация успеха
            const placeBtn = document.getElementById('placeBetBtn');
            placeBtn.style.background = 'linear-gradient(45deg, #4caf50, #66bb6a)';
            setTimeout(() => placeBtn.style.background = '', 1000);
        }

        function updateCouponHistory() {
            const historyEl = document.getElementById('couponHistory');
            historyEl.innerHTML = '';

            if (betHistory.length === 0) {
                historyEl.innerHTML = '<div class="coupon-empty">📝 История ставок пуста</div>';
                return;
            }

            betHistory.slice(-8).reverse().forEach(bet => {
                const item = document.createElement('div');
                item.className = 'history-item';
                const statusColor = bet.status === 'won' ? '#4caf50' : bet.status === 'lost' ? '#ff4444' : '#aaa';
                const statusIcon = bet.status === 'won' ? '✅' : bet.status === 'lost' ? '❌' : '⏳';
                const statusText = bet.status === 'pending' ? 'Ожидание' : bet.status === 'won' ? 'Выигрыш' : 'Проигрыш';

                item.innerHTML = `
                    <div class="history-date">${new Date(bet.date).toLocaleDateString('ru-RU')} ${new Date(bet.date).toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'})}</div>
                    <div class="history-event">${bet.events.join('<br>')}</div>
                    <div class="history-details">
                        <span>Ставка: ${bet.stake}$</span>
                        <span>Коэф: ${bet.odds}</span>
                        <span style="color: ${statusColor}; font-weight: bold;">${statusIcon} ${statusText}</span>
                        <span style="color: ${statusColor}; font-weight: bold;">${bet.potentialWin}$</span>
                    </div>
                `;
                historyEl.appendChild(item);
            });
        }

        function updateBalance() {
            document.getElementById('balanceDisplay').textContent = `${balance.toFixed(2)}$`;
            document.getElementById('profileBalance').textContent = `${balance.toFixed(2)}$`;
        }

        // **SUPPORT CHAT**
        function initSupportChat() {
            loadSupportMessages();
            const chatInput = document.getElementById('chatInput');
            const sendBtn = document.getElementById('sendSupportBtn');
            
            if (chatInput) {
                chatInput.addEventListener('input', function() {
                    sendBtn.disabled = this.value.trim() === '';
                    if (this.value.trim()) {
                        this.parentElement.querySelector('.chat-send-btn').style.opacity = '1';
                    }
                });
                
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendSupportMessage();
                    }
                });
            }
        }

        function loadSupportMessages() {
            const chat = document.getElementById('supportChat');
            if (!chat) return;
            
            chat.innerHTML = '';
            
            if (supportMessages.length === 0) {
                const welcomeMsg = document.createElement('div');
                welcomeMsg.className = 'chat-message support';
                welcomeMsg.innerHTML = `
                    <div class="message-text"><strong>🤖 Поддержка:</strong> Здравствуйте! Я ИИ-ассистент. Опишите вашу проблему - помогу решить или передам оператору.</div>
                    <div class="message-time">${new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'})}</div>
                `;
                chat.appendChild(welcomeMsg);
                return;
            }
            
            supportMessages.forEach(msg => {
                const messageEl = document.createElement('div');
                messageEl.className = `chat-message ${msg.isUser ? 'user' : 'support'}`;
                messageEl.innerHTML = `
                    <div class="message-text"><strong>${msg.isUser ? '👤 Вы' : '🤖 Поддержка'}:</strong> ${msg.text}</div>
                    <div class="message-time">${new Date(msg.timestamp).toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'})}</div>
                `;
                chat.appendChild(messageEl);
            });
            
            chat.scrollTop = chat.scrollHeight;
        }

        function sendSupportMessage() {
            const chatInput = document.getElementById('chatInput');
            const message = chatInput.value.trim();
            
            if (!message) return;
            
            // Добавляем сообщение пользователя
            supportMessages.push({
                text: message,
                isUser: true,
                timestamp: Date.now()
            });
            
            chatInput.value = '';
            document.getElementById('sendSupportBtn').disabled = true;
            
            loadSupportMessages();
            localStorage.setItem('supportMessages', JSON.stringify(supportMessages));
            
            // **УМНЫЕ АВТООТВЕТЫ**
            setTimeout(() => {
                const responses = {
                    'пополнить': 'Для пополнения баланса используйте кнопку "Пополнить" в профиле. Доступны карты, криптовалюта и Qiwi.',
                    'вывод': 'Вывод средств доступен от 10$. Заявки обрабатываются в течение 24 часов. Проверьте статус в профиле.',
                    'ставка': 'Если ставка не прошла, проверьте статус в истории. При технических проблемах напишите детали.',
                    'коэффициент': 'Коэффициенты обновляются в реальном времени. Для live-матчей возможны изменения за секунды.',
                    'регистрация': 'Для регистрации достаточно авторизации через Telegram. Профиль создается автоматически.',
                    default: 'Спасибо за обращение! Наш оператор свяжется с вами в течение часа. Можете описать проблему подробнее?'
                };
                
                const lowerMessage = message.toLowerCase();
                let responseText = responses.default;
                
                for (const [key, response] of Object.entries(responses)) {
                    if (lowerMessage.includes(key)) {
                        responseText = response;
                        break;
                    }
                }
                
                supportMessages.push({
                    text: responseText,
                    isUser: false,
                    timestamp: Date.now()
                });
                
                loadSupportMessages();
                localStorage.setItem('supportMessages', JSON.stringify(supportMessages));
                
                TelegramWebApp?.HapticFeedback.impactOccurred('light');
            }, 800 + Math.random() * 1200); // Случайная задержка 0.8-2 сек
            
            showQuickBetToast('📤 Сообщение отправлено!', 'success');
            TelegramWebApp?.HapticFeedback.impactOccurred('medium');
        }

        // **МОДАЛЬНЫЕ ОКНА**
        function showModal(modalId) {
            document.getElementById(`${modalId}Modal`).classList.add('show');
            TelegramWebApp?.HapticFeedback.impactOccurred('light');
        }

        function hideModal(modalId) {
            document.getElementById(`${modalId}Modal`).classList.remove('show');
        }

        // **УВЕДОМЛЕНИЯ**
        function showQuickBetToast(message, type = 'default') {
            const toast = document.getElementById('quickBetToast');
            toast.textContent = message;
            toast.className = type;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, type === 'error' ? 2500 : 2000);
        }

        function showSwipeHint() {
            if (!swipeHintShown && TelegramWebApp) {
                const hint = document.getElementById('swipeHint');
                hint.classList.add('show');
                setTimeout(() => {
                    hint.classList.remove('show');
                    swipeHintShown = true;
                }, 4000);
            }
        }

        // **СВАЙП НАВИГАЦИЯ**
        function initSwipeNavigation() {
            let touchStartX = 0, touchStartY = 0;
            
            document.addEventListener('touchstart', (e) => {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            }, { passive: true });

            document.addEventListener('touchmove', (e) => {
                if (!TelegramWebApp) return;
                
                const touchEndX = e.touches[0].clientX;
                const touchEndY = e.touches[0].clientY;
                const diffX = touchStartX - touchEndX;
                const diffY = Math.abs(touchStartY - touchEndY);
                
                // Горизонтальный свайп
                if (Math.abs(diffX) > 50 && diffY < 30) {
                    e.preventDefault();
                    
                    const sections = document.querySelectorAll('.events-section');
                    if (diffX > 0) {
                        // Свайп влево - следующая секция
                        currentSectionIndex = Math.min(currentSectionIndex + 1, sections.length - 1);
                    } else {
                        // Свайп вправо - предыдущая секция
                        currentSectionIndex = Math.max(currentSectionIndex - 1, 0);
                    }
                    
                    sections.forEach((section, index) => {
                        section.style.transform = `translateX(${(index - currentSectionIndex) * 20}px)`;
                        section.style.opacity = index === currentSectionIndex ? '1' : '0.7';
                        section.style.zIndex = index === currentSectionIndex ? '2' : '1';
                    });
                    
                    TelegramWebApp.HapticFeedback.impactOccurred('light');
                }
            }, { passive: false });
        }

        // **LIVE TIMER**
        function startLiveTimer(matchData) {
            if (!matchData.status === 'live') return;

            let matchMinute = matchData.currentMinute || 0;
            const timerElement = document.getElementById('liveIndicator');
            
            if (!timerElement) return;

            const updateTimer = () => {
                if (matchMinute < 90) {
                    matchMinute++;
                    timerElement.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 8px; height: 8px; background: #4caf50; border-radius: 50%; animation: liveDot 1s infinite;"></div>
                            LIVE ${matchMinute}'
                        </div>
                    `;
                    
                    // Добавляем анимацию для опасных моментов
                    if (matchMinute % 15 === 0) {
                        timerElement.style.background = 'linear-gradient(45deg, #ff9800, #ff5722)';
                        setTimeout(() => {
                            timerElement.style.background = 'linear-gradient(45deg, #ff4444, #ff0066)';
                        }, 1000);
                    }
                }
            };

            updateTimer(); // Первое обновление
            const timerInterval = setInterval(updateTimer, 60000); // Обновляем каждую минуту

            // Останавливаем таймер при закрытии страницы
            window.addEventListener('beforeunload', () => clearInterval(timerInterval));
        }

        function updateLiveStats(liveStats) {
            const statsSection = document.querySelector('#statsSection');
            let liveStatsPanel = document.getElementById('liveStatsPanel');
            
            if (liveStatsPanel) liveStatsPanel.remove();

            liveStatsPanel = document.createElement('div');
            liveStatsPanel.id = 'liveStatsPanel';
            liveStatsPanel.style.cssText = `
                background: linear-gradient(145deg, rgba(255,68,68,0.15), rgba(255,0,102,0.1));
                border: 2px solid rgba(255, 68, 68, 0.4); border-radius: 16px; 
                padding: 20px; margin: 20px 0; font-size: 0.9rem;
                animation: liveStatsPulse 2s infinite;
            `;

            liveStatsPanel.innerHTML = `
                <div style="font-size: 1.4rem; color: #ff4444; margin-bottom: 18px; text-align: center; font-weight: bold; text-shadow: 0 0 15px rgba(255,68,68,0.5); text-transform: uppercase; letter-spacing: 1px;">
                    ⚡ LIVE СТАТИСТИКА
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 15px; text-align: center;">
                    <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px; border: 1px solid rgba(255,68,68,0.2);">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 4px; text-transform: uppercase;">Владение</div>
                        <div style="font-size: 1.4rem; font-weight: bold; color: var(--primary-color);">${liveStats.possession?.home || 52}% - ${liveStats.possession?.away || 48}%</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px; border: 1px solid rgba(255,68,68,0.2);">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 4px; text-transform: uppercase;">Удары в створ</div>
                        <div style="font-size: 1.4rem; font-weight: bold; color: var(--primary-color);">${liveStats.shotsOnTarget?.home || 3} - ${liveStats.shotsOnTarget?.away || 2}</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px; border: 1px solid rgba(255,68,68,0.2);">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 4px; text-transform: uppercase;">Угловые</div>
                        <div style="font-size: 1.4rem; font-weight: bold; color: var(--primary-color);">${liveStats.corners?.home || 4} - ${liveStats.corners?.away || 2}</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px; border: 1px solid rgba(255,68,68,0.2);">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 4px; text-transform: uppercase;">Карточки</div>
                        <div style="font-size: 1.4rem; font-weight: bold; color: var(--primary-color);">${liveStats.yellowCards?.home || 1} - ${liveStats.yellowCards?.away || 0}</div>
                    </div>
                </div>
            `;

            statsSection.insertBefore(liveStatsPanel, statsContainer);
        }

        // **EVENT LISTENERS**
        function setupEventListeners() {
            // Клик вне модалки
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        const modalId = modal.id.replace('Modal', '');
                        hideModal(modalId);
                    }
                });
            });

            // Клик вне купона
            document.addEventListener('click', (e) => {
                const coupon = document.getElementById('betCoupon');
                if (coupon.classList.contains('visible') && !coupon.contains(e.target) && !e.target.closest('.event-item')) {
                    closeCoupon();
                }
            });

            // ESC клавиша
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    const visibleModal = document.querySelector('.modal.show');
                    if (visibleModal) {
                        const modalId = visibleModal.id.replace('Modal', '');
                        hideModal(modalId);
                    } else if (document.getElementById('betCoupon').classList.contains('visible')) {
                        closeCoupon();
                    }
                }
            });

            // Методы депозита
            document.addEventListener('click', (e) => {
                if (e.target.closest('.deposit-method')) {
                    document.querySelectorAll('.deposit-method').forEach(m => {
                        m.classList.remove('active');
                    });
                    e.target.closest('.deposit-method').classList.add('active');
                }
            });

            // Быстрые суммы для депозита
            document.querySelectorAll('.deposit-amount button').forEach(btn => {
                btn.addEventListener('click', () => {
                    const input = btn.closest('.deposit-amount').querySelector('input');
                    input.value = btn.textContent.replace('$', '');
                    input.focus();
                });
            });
        }

        function showNotifications() {
            showQuickBetToast('🔔 Уведомления в разработке', 'error');
        }

        function openProfile() {
            if (!isLoggedIn) {
                showModal('login');
                return;
            }
            document.getElementById('profileName').textContent = currentUser.username;
            document.getElementById('profileBalance').textContent = `${balance.toFixed(2)}$`;
            showModal('profile');
        }

        function closeProfile() {
            hideModal('profile');
        }

        function openHistory() {
            updateCouponHistory();
            hideModal('profile');
            showModal('history');
        }

        function closeHistory() {
            hideModal('history');
        }

        function openDepositModal() {
            if (!isLoggedIn) {
                showModal('login');
                showQuickBetToast('🔐 Войдите для пополнения', 'error');
                return;
            }
            showModal('deposit');
            document.getElementById('depositAmount').value = '';
        }

        function closeDepositModal() {
            hideModal('deposit');
        }

        function processDeposit() {
            const amount = parseFloat(document.getElementById('depositAmount').value);
            const method = document.querySelector('.deposit-method.active')?.dataset.method;
            
            if (!method) {
                showQuickBetToast('Выберите способ пополнения', 'error');
                return;
            }
            
            if (isNaN(amount) || amount <= 0) {
                showQuickBetToast('Введите корректную сумму', 'error');
                return;
            }

            balance += amount;
            localStorage.setItem('balance', balance);
            updateBalance();
            
            showQuickBetToast(`💰 Баланс пополнен на ${amount}$ через ${method.toUpperCase()}!`, 'success');
            closeDepositModal();
            document.getElementById('depositAmount').value = '';
            
            TelegramWebApp?.HapticFeedback.notificationOccurred('success');
        }

        function performLogout() {
            isLoggedIn = false;
            currentUser = null;
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('currentUser');
            updateAuthUI();
            showQuickBetToast('👋 Вы вышли из аккаунта', 'error');
            closeProfile();
            document.getElementById('connectTgBtn').style.display = 'inline-block';
        }

        // **Инициализация**
        initApp();
    </script>
</body>
</html>